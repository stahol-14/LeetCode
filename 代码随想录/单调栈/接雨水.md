# [æ¥é›¨æ°´](æ¥é›¨æ°´"[é¢˜ç›®åœ°å€](https://leetcode.cn/problems/trapping-rain-water/description/)")

## é¢˜ç›®æè¿°
ç»™å®š n ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

### æ€è·¯1ï¼šå•è°ƒæ ˆğŸŒŸ

- æŒ‰ç…§**è¡Œè®¡ç®—**
- å•è°ƒæ ˆä¸­å¯¹åº”çš„å…ƒç´ æ˜¯**é€’å¢çš„**ï¼ˆæ ˆé¡¶åˆ°æ ˆåº•ï¼‰â€”â€” æŒ‡å‘çš„å…ƒç´ ï¼Œå¤§äºæ ˆé¡¶æ—¶ï¼Œå½¢æˆå‡¹æ§½ï¼Œå¯ä»¥æ¥é›¨æ°´ã€‚ã€å­˜ä¸‹æ ‡ã€‘
- å½“é‡åˆ°ç›¸åŒé«˜åº¦çš„æŸ±å­æ—¶ï¼Œéœ€è¦**æ›´æ–°ä¸‹æ ‡**

æ³¨ï¼šè®¡ç®—é¢ç§¯çš„å®½åº¦æ—¶ï¼Œæ˜¯**å‡1**è€Œä¸æ˜¯åŠ 1
- å› ä¸ºä¸åŒ…æ‹¬è¾¹ç•ŒæŸ±å­æœ¬èº«
  - i æ˜¯å³è¾¹ç•ŒæŸ±å­ä¸‹æ ‡
  - left æ˜¯å·¦è¾¹ç•ŒæŸ±å­ä¸‹æ ‡
  - ä¸­é—´å¯ä»¥ç››æ°´çš„å¤§å°æ˜¯ i - left - 1 ä¸ªæ ¼å­

```java
class Solution {
    public int trap(int[] height) {
        // å•è°ƒæ ˆ ä¸‹æ ‡å¯¹åº”çš„å€¼ é€’å¢ï¼ˆæ ˆé¡¶åˆ°æ ˆåº•ï¼‰
        if(height == null || height.length <= 1){
            return 0;
        }

        int res = 0;
        int n = height.length;
        Deque<Integer> stack = new ArrayDeque<>(); // å•è°ƒæ ˆ å­˜æ”¾ä¸‹æ ‡

        for(int i = 0; i < n; i++){
            // åˆ¤æ–­å½“å‰é«˜åº¦ ä¸ æ ˆé¡¶å¯¹åº”é«˜åº¦çš„å…³ç³» å¤§äºåˆ™å½¢æˆå‡¹æ§½
            while( (!stack.isEmpty()) && height[i] > height[stack.peek()] ){
                // ç¡®å®šæŸ±å­çš„ç›¸å¯¹ä½ä¾§
                int bottom = stack.pop(); // æŸ±å­åº•éƒ¨
                if(stack.isEmpty()) break; // æ²¡æœ‰å·¦è¾¹ç•Œ

                int left = stack.peek();
                int width = i - left - 1;

                int minHeight = Math.min(height[left], height[i]);
                int curRes = (minHeight - height[bottom]) * width;
                res += curRes;
            }
            
            stack.push(i); // å½“å‰ä¸‹æ ‡å…¥æ ˆ
        }

        return res;
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(n)

ç©ºé—´å¤æ‚åº¦ï¼šO(n)

----

### æ€è·¯2.1ï¼šåŒæŒ‡é’ˆğŸŒŸ

- æŒ‰åˆ—è®¡ç®—

```java
class Solution {
    public int trap(int[] height) {
        // åŒæŒ‡é’ˆ â€”â€” æŒ‰åˆ—è®¡ç®—
        if(height == null || height.length <= 1) return 0;

        int res = 0;
        int left = 0, right = height.length - 1;
        int leftMax = height[left], rightMax = height[right]; // å½“å‰åˆ—å·¦å³ä¾§çš„é«˜åº¦

        while(left < right){
            if(height[left] < height[right]){
                // å·¦è¾¹æ¯”å³è¾¹çŸ®ï¼Œå†³å®šé«˜åº¦ä¸Šé™çš„æ˜¯å·¦è¾¹
                left++;
                leftMax = Math.max(leftMax, height[left]);
                res += leftMax - height[left]; // æ¥æ°´ = å·¦è¾¹æœ€é«˜ - å½“å‰é«˜åº¦ï¼ˆ>=0ï¼‰
            }else{
                // å³è¾¹æ¯”å·¦è¾¹çŸ®ï¼Œå†³å®šé«˜åº¦ä¸Šé™çš„æ˜¯å³è¾¹
                right--;
                rightMax = Math.max(rightMax, height[right]);
                res += rightMax - height[right];
            }
        }

        return res;
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(n)

ç©ºé—´å¤æ‚åº¦ï¼šO(1)

----

### æ€è·¯2.2ï¼šåŒæŒ‡é’ˆğŸŒŸï¼ˆé¢ç§¯ç›¸å‡ï¼‰

- æ¥é›¨æ°´åçš„é¢ç§¯ - æŸ±å­çš„é¢ç§¯
- ä¸€å±‚ä¸€å±‚çš„è®¡ç®—ï¼ˆæŒ‰è¡Œè®¡ç®—ï¼‰

1. å°†æ•´ä¸ªæŸ±å­è§†ä¸ºç”±ä¸€å±‚å±‚æ°´é¢ç»„æˆçš„ï¼›
2. æ¯ä¸€å±‚æ°´é¢ hï¼Œä»å·¦åˆ°å³çœ‹ï¼Œæ‰¾åˆ°å·¦å³è¾¹ç•Œéƒ½ â‰¥ h çš„ä½ç½®ï¼›
3. ä¸­é—´ï¼ˆright - left + 1ï¼‰èŒƒå›´å†…çš„æ–¹å—éƒ½å±äºè¿™å±‚æ°´çš„é¢ç§¯ï¼›
4. æ€»æ°´å±‚é¢ç§¯ç´¯åŠ åˆ° sumArea ä¸­ï¼›
5. æŸ±å­é¢ç§¯ä¸º areaï¼Œæœ€ç»ˆç»“æœå°±æ˜¯ sumArea - areaã€‚

```java
class Solution {
    public int trap(int[] height) {
        if(height == null || height.length <= 1){
            return 0;
        }

        // åŒæŒ‡é’ˆ é¢ç§¯ç›¸å‡
        int area = 0; // æŸ±å­çš„é«˜åº¦
        for(int temp : height){
            area += temp;
        }
        
        int sumArea = 0; // æ¥å®Œé›¨æ°´åçš„æ€»é«˜åº¦
        int left = 0, right = height.length - 1;
        int h = 1; // ä»ç¬¬1å±‚é«˜åº¦å¼€å§‹çŒæ°´

        while(left <= right){
            // å½“å‰å±‚çš„å·¦å³è¾¹ç•Œå¿…é¡»éƒ½ â‰¥ å½“å‰å±‚é«˜åº¦ hï¼Œæ‰èƒ½æ¥æ°´
            if(height[left] < h){
                left++;
                continue;
            }
            if(height[right] < h){
                right--;
                continue;
            }

            // å¦‚æœå·¦å³è¾¹ç•Œéƒ½ â‰¥ hï¼Œè¿™ä¸€å±‚å¯ä»¥çŒæ°´
            sumArea += right - left + 1;
            h++;
        }

        // ç”¨æ€»æ°´å±‚é¢ç§¯ - æŸ±å­é¢ç§¯ = æ°´çš„ä½“ç§¯
        return sumArea - area;
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(n)

ç©ºé—´å¤æ‚åº¦ï¼šO(1)

### æ€»ç»“
