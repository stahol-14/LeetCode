# [å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°](å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°"[é¢˜ç›®åœ°å€](https://leetcode.cn/problems/count-complete-tree-nodes/description/)")

## é¢˜ç›®æè¿°
ç»™ä½ ä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹`root`ï¼Œæ±‚å‡ºè¯¥æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚

**å®Œå…¨äºŒå‰æ ‘**çš„å®šä¹‰å¦‚ä¸‹ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œé™¤äº†æœ€åº•å±‚èŠ‚ç‚¹å¯èƒ½æ²¡å¡«æ»¡å¤–ï¼Œå…¶ä½™æ¯å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œå¹¶ä¸”æœ€ä¸‹é¢ä¸€å±‚çš„èŠ‚ç‚¹éƒ½é›†ä¸­åœ¨è¯¥å±‚æœ€å·¦è¾¹çš„è‹¥å¹²ä½ç½®ã€‚è‹¥æœ€åº•å±‚ä¸ºç¬¬ h å±‚ï¼ˆä»ç¬¬ 0 å±‚å¼€å§‹ï¼‰ï¼Œåˆ™è¯¥å±‚åŒ…å« 1~ 2h ä¸ªèŠ‚ç‚¹ã€‚


### æ€è·¯1ï¼šé€’å½’


```java
class Solution {
    public int countNodes(TreeNode root) {
        // é€’å½’
        if(root == null) return 0;
        
        return 1 + countNodes(root.left) + countNodes(root.right);
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(n)
ç©ºé—´å¤æ‚åº¦ï¼šO(n)

----
### æ€è·¯2ï¼šè¿­ä»£BFS


```java
class Solution {
    public int countNodes(TreeNode root) {
        // BFSå±‚åºéå† 
        if(root == null) return 0;
        int res = 0;
        Queue<TreeNode> queue = new LinkedList<>();
        queue.offer(root);
        while(!queue.isEmpty()){
            TreeNode node = queue.poll();
            res++;
            if(node.left != null) queue.offer(node.left);
            if(node.right != null) queue.offer(node.right);
        }
        return res;
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(n)
ç©ºé—´å¤æ‚åº¦ï¼šO(n)

----

### æ€è·¯3ï¼šåˆ©ç”¨å®Œå…¨äºŒå‰æ ‘çš„ç‰¹ç‚¹ğŸŒŸ
- å¯¹äºä¸€æ£µæ»¡äºŒå‰æ ‘ï¼ŒèŠ‚ç‚¹æ•°ä¸º`2^h - 1`ï¼Œå…¶ä¸­ h æ˜¯æ ‘çš„é«˜åº¦ï¼›
- å¦‚æœå½“å‰å­æ ‘æ˜¯æ»¡çš„ï¼Œå°±ä¸å¿…å†é€’å½’è®¡ç®—å­æ ‘ï¼Œç›´æ¥ç”¨å…¬å¼è®¡ç®—èŠ‚ç‚¹æ•°ï¼›
- å¦‚æœä¸æ˜¯æ»¡çš„ï¼Œé€’å½’å·¦å³å­æ ‘ç»§ç»­åˆ¤æ–­ã€‚

```java
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode() {}
 *     TreeNode(int val) { this.val = val; }
 *     TreeNode(int val, TreeNode left, TreeNode right) {
 *         this.val = val;
 *         this.left = left;
 *         this.right = right;
 *     }
 * }
 */
class Solution {
    public int countNodes(TreeNode root) {
        // åˆ©ç”¨å®Œå…¨äºŒå‰æ ‘çš„ç‰¹æ€§
        if(root == null) return 0;

        int leftDepth = getDepth(root.left);
        int rightDepth = getDepth(root.right);

        if(leftDepth == rightDepth){
            // å·¦å­æ ‘æ˜¯ä¸€ä¸ªæ»¡äºŒå‰æ ‘ï¼ˆå®Œå…¨å¡«æ»¡çš„ä¸€æ•´å±‚ï¼‰
            return (1 << leftDepth) + countNodes(root.right);
        }else{
            // å³å­æ ‘æ˜¯ä¸€ä¸ªæ»¡äºŒå‰æ ‘ï¼ˆä½†å…¶é«˜åº¦ < å·¦å­æ ‘ï¼‰
            return (1 << rightDepth) + countNodes(root.left);
        }
    }

    // è®¡ç®—ä»¥ node ä¸ºæ ¹çš„æ ‘çš„æœ€å¤§æ·±åº¦ï¼ˆå‘å·¦èµ°ï¼‰
    private int getDepth(TreeNode node){
        int depth = 0;
        while (node != null) {
            node = node.left;
            depth++;
        }
        return depth;
    }
}
```

#### å¤æ‚åº¦åˆ†æ
æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
ç©ºé—´å¤æ‚åº¦ï¼šO(1)

### æ€»ç»“
> `1 << h` å°±æ˜¯ `2^h`ï¼Œå·¦ç§»ä½è¿ç®—ï¼Œç›¸å½“äºå¿«é€Ÿä¹˜æ³•ã€‚
> å¸¸ç”¨äºä½è¿ç®—ä¼˜åŒ–ã€å®Œå…¨äºŒå‰æ ‘èŠ‚ç‚¹æ•°è®¡ç®—ç­‰åœºæ™¯ã€‚